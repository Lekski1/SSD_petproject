# Snort IDS/IPS System | SA Team

<div style="display: flex; align-items: flex-start;">
    <div style="margin-right: 40px;"> 
        <pre>
.      (\_/)
.      (•_• )
.   ＿ノ ヽ /＼ __
.  / /  ⌒Y⌒ ヽ|  \
. | __⌒＼ ￣￣ヽ   |
. ヽ＿＿＿＞､＿＿_／
.     ｜( 王 )〈
.     / ﾐー――彡 \
        </pre>
    </div>
    <div>
        <b>Team:</b><br>
        1. Eldar Mametov<br>
        2. Aleksandr Ryabov<br>
        3. Mikhail Voronin<br>
        4. Artem Bulgakov<br>
        5. Ruslan Belkov<br>
        <br> 
        <b>Github Repository:</b><br>
        <a href="https://github.com/Lekski1/SSD_petproject">https://github.com/Lekski1/SSD_petproject</a>
    </div>
</div>

---

## Table of Contents (Содержание)

- [Snort IDS/IPS System | SA Team](#snort-idsips-system--sa-team)
  - [Table of Contents (Содержание)](#table-of-contents-содержание)
  - [Введение (Introduction)](#введение-introduction)
  - [Методы (Methods)](#методы-methods)
  - [Результаты (Results)](#результаты-results)
  - [Обсуждение (Discussion)](#обсуждение-discussion)

---

## Введение (Introduction)

**Цель проекта:**
В рамках данного проекта реализуется задача развертывания и настройки системы обнаружения/предотвращения вторжений (IDS/IPS) Snort или Suricata перед веб-приложением. Проект включает следующие ключевые этапы, основанные на требованиях учебного курса:

*   Развертывание Snort IDS/IPS системы.
*   Применение адекватной конфигурации безопасности, с кастомизацией минимум 3 настроек.
*   Моделирование атаки на веб-приложение.
*   Детектирование и/или предотвращение смоделированной атаки с помощью IDS/IPS.

**Выбор Инструмента (Snort V2):**    
В качестве IDS/IPS был выбран Snort версии 2. Он был выбран по следующим причинам:        
*   Наличие у части команды предыдущего опыта работы с Snort V2, что ускоряет процесс развертывания и начальной настройки.
*   Относительная простота установки и конфигурации по сравнению с более новой версией.
*   Избытачность функционала Snort V3. Snort второй версии имеет весь необходимый функционал для выполнения проекта. 

## Методы (Methods)

Для реализации проекта мы использовали vps сервер на котором и развернули все необходимые компоненты для тестирования нашего проекта 

1.  **Разработка целевого веб-приложения на FastAPI:**
    *   Было разработано простое веб-приложение на фреймворке FastAPI.
    *   Каждый участник реализовал определенный Endpoint, намеренно содержащий специфическую уязвимость.
    *  Внедренные уязвимости соответствующими участниками команды: 
        *   XSS (Cross-Site Scripting) - Артем Булгаков
        *   Server-Side Request Forgery (SSRF) - Александр Рябов
        *   Path Traversal - Руслан Бельков
        *   XXE (XML External Entity) - Михаил Воронин
        *   SQL-инъекция - Эльдар Маметов

2.  **Индивидуальная проработка уязвимостей и правил Snort:**
    *   Для каждой внедренной уязвимости (один Endpoint на каждого участника команды), ответственный участник разрабатывал специализированные правила для Snort V2.
    *   Целью написанный правил является обнаружение популярных методов атак на их Endpoint и предотвращение этой атаки. 

3.  **Настройка инфраструктуры:**
    *   Развертывание Snort V2 на vps на базе ubuntu 24.
    *   Использование контейнеризации (Docker) для развертывания веб-приложения на FastAPI и написание Nginx конфигураций для корректной работы двух сайтов на одном vps-сервере. За конфигурацию контейнеров и Nginx отвечал Михаил Воронин.
    *   Базовая конфигурация Snort, включая настройку сети и подключение правил, осуществлялась Эльдаром Маметовым.

4.  **Дополнительное тестирование на Juice Shop:**
    *   Для тестирования стандартных правил snort от комьюнити был дополнительно развернут juice-shop, который включает в себя множество уязвимостей и под него запущен отдельный snort.conf для тестирования его работы. 

## Результаты (Results)

*[Этот раздел должен быть заполнен по мере выполнения проекта. Опишите здесь, что *фактически* было достигнуто.]*


## Обсуждение (Discussion)

В ходе выполнения проекта поставленные цели были успешно достигнуты: система Snort была развернута и настроена, а разработанные правила эффективно детектируют и предотвращают атаки на целевое веб-приложение. Все пять смоделированных уязвимостей (XSS, SSRF, Path Traversal, XXE и SQL-инъекция) надежно блокируются специально созданными сигнатурами. Дополнительное тестирование на OWASP Juice Shop с использованием стандартных правил сообщества также подтвердило работоспособность конфигурации и стабильность развернутой инфраструктуры.

**Ключевые выводы и результаты:**

1.  **Эффективность кастомных правил:** Разработанные командой правила для Snort V2 продемонстрировали свою состоятельность в отражении базовых векторов атак. Этот процесс позволил участникам углубить понимание механизмов эксплуатации специфических уязвимостей и освоить практические навыки написания эффективных сигнатур для IDS/IPS.
2.  **Практический опыт команды:** Каждый член команды успешно справился с индивидуальной задачей по созданию уязвимого эндпоинта и разработке соответствующего правила Snort, что способствовало коллективному росту компетенций в области сетевой безопасности.
3.  **Выбор Snort V2:** Для данного учебного проекта функционала Snort V2 оказалось достаточно, и команда не столкнулась с существенными ограничениями. Однако стоит отметить, что для более сложных, высоконагруженных производственных сред актуальнее была бы Snort V3. Преимущества третьей версии, такие как возможность "горячей" перезагрузки правил без остановки сервиса, улучшенная масштабируемость и расширенные возможности для глубокого анализа трафика (включая подключение модулей для анализа прикладного уровня), делают ее более предпочтительной в реальных сценариях.

**Перспективы дальнейшего развития:**

Если бы данный проект развивался в направлении защиты коммерческого продукта с активной пользовательской базой, фокус был бы смещен на следующие аспекты:

*   **Расширение базы правил:** Не только создание правил, блокирующих однозначно вредоносные пакеты, но и разработка сигнатур для генерации предупреждений о подозрительной активности, требующей дополнительного анализа.
*   **Мониторинг и аналитика:** Внедрение системы непрерывного мониторинга событий безопасности, сбор и анализ логов для выявления аномалий и паттернов атак.
*   **Проактивное обновление правил:** Регулярное обновление существующих и написание новых правил на основе анализа актуальных угроз, бюллетеней безопасности и данных из фидов Threat Intelligence.
*   **Интеграция с SIEM/SOAR:** Подключение Snort к системам управления информацией о безопасности и событиями (SIEM) для корреляции данных с другими источниками и, возможно, к платформам SOAR для автоматизации некоторых процессов реагирования.
*   **Тестирование и оптимизация:** Постоянное тестирование эффективности правил (включая тесты на ложные срабатывания) и оптимизация производительности Snort для минимизации влияния на сетевой трафик.

В целом, проект позволил получить ценный практический опыт в развертывании, настройке и эксплуатации IDS/IPS системы, а также в разработке сигнатур для детектирования и предотвращения веб-атак.